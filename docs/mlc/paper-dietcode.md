# DIETCODE: AUTOMATIC OPTIMIZATION FOR DYNAMIC TENSOR PROGRAMS


## 0. Abstract
将现有的自动调度程序直接应用于动态形状的工作负载很困难，因为往往会需要极长的自动调度时间。

我们观察到: 现有自动调度器在处理动态形状工作负载时面临的主要挑战是它们无法为所有可能的工作负载形状构建统一的搜索空间，因为它们的搜索空间是依赖于形状的。 为了解决这个问题，我们提出了 DietCode，这是一种新的自动调度程序框架，它通过构建一个形状通用的搜索空间和 cost model 来有效地支持动态形状的工作负载。 在这种结构下，所有形状在同一空间内联合搜索并在自动调度时更新相同的成本模型，因此与现有的自动调度器相比效率更高。

评估表明，DietCode 在端到端自动安排整个模型时具有以下关键优势：(1) 将自动安排时间减少了 5.88 倍，比最先进的自动安排程序少 在均匀采样的动态形状上（如果包括所有可能的形状，估计为 94.1 倍），(2) 比自动调度程序提高了 69.5% 的性能，比供应商库提高了 18.6%。 所有这些优势使 DietCode 成为动态形状工作负载的高效实用解决方案。


# 1. Intro
